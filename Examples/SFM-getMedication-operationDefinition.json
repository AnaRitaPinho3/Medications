{
	"resourceType": "OperationDefinition",
	"id": "SFM-getMedication",
	"text": {
		"status": "generated",
		"div": "<div>Operation definition for SFM specific operation: $getMedication</div>"
	},
	"url": "http://hl7.org/fhir/OperationDefinition/SFM-getMedication",
	"version": "1.0.0",
	"name": "getMedication",
	"title": "Operation for lookup medical and prescription information for a patient",
	"status": "draft",
	"kind": "operation",
	"date": "2020-04-06T14:50:00+02:00",
	"publisher": "Norsk Helsenett (SFM Project)",
	"contact": [
		{
			"telecom": [
				{
					"system": "url",
					"value": "http://nhn.no/fhir"
				},
				{
					"system": "email",
					"value": "SFM-Prosjekt@nhn.no"
				}
			]
		}
	],
	"description": "This operation provides lookup in Kjernejournal and/or Reseptformidleren to collect and aggregate information on prescriptions, medication treatement, PLL (Pasientens LegemiddeListe), dispense information and Critical information",
	"code": "getMedication",
	"comment": "This operation is complex, and requier that the Practitioner performing the operation presents a valid HelseID token with identity information, and that the authorisation is available in Helsepersonellregisteret",
	"resource": [
		"Patient"
	],
	"system": false,
	"type": true,
	"instance": false,
	"parameter": [
		{
			"name": "patient",
			"use": "in",
			"min": 1,
			"max": "1",
			"documentation": "Must be present and contain Name, Address and (identifier OR (birthDate + gender))",
			"type": "Patient"
		},
		{
			"name": "Referansenummer",
			"use": "in",
			"min": 0,
			"max": "*",
			"documentation": "Refereansenummer shall always be present for patient without national ID. Referansenummer may be present for retreival of l√•st resept, doctors-name prescriptions or other",
			"type": "string"
		},
		{
			"name": "historyTimestamp",
			"use": "in",
			"min": 0,
			"max": "1",
			"documentation": "If this is nominated, then the resource is validated against this specific profile. If a profile is nominated, and the server cannot validate against the nominated profile, it SHALL return an error",
			"type": "dateTime"
		},
		{
			"name": "SamtykkeKjernejournal",
			"use": "in",
			"min": 0,
			"max": "1",
			"documentation": "If the operation outcome does not list any errors, and a mode was specified, then this is an indication that the operation would be expected to succeed (excepting for transactional integrity issues, see below)",
			"type": "code",
			"binding": {
				"strength": "required",
				"valueSet": "TODO: fyll ut for samtykkeverdiene"
			}
		},
		{
			"name": "SamtykkeSperretLegemidler",
			"use": "in",
			"min": 0,
			"max": "1",
			"documentation": "If the operation outcome does not list any errors, and a mode was specified, then this is an indication that the operation would be expected to succeed (excepting for transactional integrity issues, see below)",
			"type": "code",
			"binding": {
				"strength": "required",
				"valueSet": "TODO: fyll ut for samtykkeverdiene"
			}
		},
		{
			"name": "SamtykkeLasteResepter",
			"use": "in",
			"min": 0,
			"max": "1",
			"documentation": "If the operation outcome does not list any errors, and a mode was specified, then this is an indication that the operation would be expected to succeed (excepting for transactional integrity issues, see below)",
			"type": "code",
			"binding": {
				"strength": "required",
				"valueSet": "TODO: fyll ut for samtykkeverdiene"
			}
		},
		{
			"name": "medication",
			"use": "out",
			"min": 1,
			"max": "1",
			"documentation": "Main result. Medication bundle document",
			"type": "Bundle"

		},
		{
			"name": "KJHentetTidspunkt",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "Time for result from KJ. Absensce shall be interpreted as no lookup performed",
			"type": "dateTime"
		},
		{
			"name": "RFHentetTidspunkt",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "Time for result from RF. Absensce shall be interpreted as no lookup performed",
			"type": "dateTime"
		},
		{
			"name": "KJFeilkode",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "Error response from KJ",
			"type": "Coding",
			"binding": {
				"strength": "required",
				"valueSet": "http://ehelse.no/fhir/ValueSet/sfm-rfkj-lookupcodes"
			}

		},
		{
			"name": "RFM96Feilkode",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "Error response from KJ",
			"type": "Coding",
			"binding": {
				"strength": "required",
				"valueSet": "http://ehelse.no/fhir/ValueSet/sfm-rfkj-lookupcodes"
			}
		},
		{
			"name": "RFM912Feilkode",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "Error response from KJ",
			"type": "Coding",
			"binding": {
				"strength": "required",
				"valueSet": "http://ehelse.no/fhir/ValueSet/sfm-rfkj-lookupcodes"
			}
		},
		{
			"name": "KJHarLegemidler",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "According to response from KJ",
			"type": "boolean"
		},
		{
			"name": "KJHarLaste",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "According to response from KJ",
			"type": "boolean"
		},
		{
			"name": "RFHarLaste",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "According to response from RF",
			"type": "boolean"
		},
		{
			"name": "RFPasientreservasjon",
			"use": "out",
			"min": 0,
			"max": "1",
			"documentation": "According to response from RF",
			"type": "boolean"
		}
		
	]
}